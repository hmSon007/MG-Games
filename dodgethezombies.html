<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Emoji KaÃ§ma Oyunu</title>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background-color: #1a1a1a;
            font-family: 'Arial', sans-serif;
            color: #fff;
            flex-direction: column;
            user-select: none;
            text-align: center;
        }
        /* Neon parÄ±ltÄ± efekti */
        .neon-glow {
            box-shadow: 0 0 5px #059669, 0 0 10px #059669, 0 0 15px #059669;
        }

        /* Neon yazÄ± efekti */
        .neon-text {
            text-shadow: 0 0 5px #10b981, 0 0 10px #10b981;
        }
        /* KaydÄ±rma Ã§ubuÄŸu iÃ§in stil */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-thumb {
            background: #10b981;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #059669;
        }

        .game-container {
            position: relative;
            background-color: #333;
            border: 5px solid #555;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.4);
            overflow: hidden;
            touch-action: none;
        }
        
        #gameCanvas {
            display: block;
            background-color: #222;
        }

        #message-box {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(0, 0, 0, 0.8);
            padding: 25px;
            border-radius: 10px;
            text-align: center;
            color: #fff;
            display: none;
            z-index: 10;
        }

        #message-box h2 {
            margin-top: 0;
            font-size: 2em;
            color: #f0f0f0;
        }

        #message-box p {
            margin: 10px 0;
        }

        #restart-button {
            background-color: #4CAF50;
            border: none;
            color: white;
            padding: 15px 32px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            margin-top: 20px;
            cursor: pointer;
            border-radius: 8px;
            box-shadow: 0 4px #2e7d32;
            transition: all 0.2s ease;
        }

        #restart-button:active {
            box-shadow: 0 2px #2e7d32;
            transform: translateY(2px);
        }

        #score-display {
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 2.5em;
            font-weight: bold;
            text-shadow: 2px 2px 4px #000;
            z-index: 5;
        }
        
        #back-button {
            /* VarsayÄ±lan olarak soluk renk ve parÄ±ltÄ± yok */
            background-color: rgba(5, 150, 105, 0.4); 
            border: none;
            color: white;
            padding: 10px 15px;
            font-size: 14px;
            cursor: pointer;
            border-radius: 5px;
            margin-bottom: 10px;
            z-index: 5;
            display: none;
            transition: background-color 0.3s ease, box-shadow 0.3s ease;
        }

        #back-button:hover,
        #back-button:focus {
            /* Ãœzerine gelindiÄŸinde parlak renk ve parÄ±ltÄ± ekle */
            background-color: #059669;
            box-shadow: 0 0 5px #059669, 0 0 10px #059669, 0 0 15px #059669;
        }
        
        @media (max-width: 600px) {
            body {
                justify-content: flex-start;
                padding-top: 20px;
            }
            .game-container {
                width: 95%;
                border-width: 3px;
            }
            #score-display {
                font-size: 2em;
            }
            #message-box {
                padding: 15px;
            }
            #message-box h2 {
                font-size: 1.5em;
            }
            #restart-button {
                padding: 10px 20px;
            }
        }
    </style>
</head>
<body>
    <button id="back-button">Geri DÃ¶n</button>
    <div class="game-container neon-glow">
        <canvas id="gameCanvas"></canvas>
        <div id="score-display" class="neon-text">0</div>
        <div id="message-box">
            <h2 id="message-title" class="neon-text">HazÄ±r!</h2>
            <p id="message-text" class="neon-text">BaÅŸlamak iÃ§in fareyi hareket ettir veya dokun.</p>
            <button id="restart-button" style="display: none;">Yeniden BaÅŸla</button>
        </div>
    </div>

    <script>
        // Get canvas and context
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        // Get UI elements
        const scoreDisplay = document.getElementById('score-display');
        const messageBox = document.getElementById('message-box');
        const messageTitle = document.getElementById('message-title');
        const messageText = document.getElementById('message-text');
        const restartButton = document.getElementById('restart-button');
        const backButton = document.getElementById('back-button');

        // Game state variables
        let gameLoopId;
        let gameStarted = false;
        let gameOver = false;
        let score = 0;
        let enemies = [];
        let lastEnemySpawnTime = 0;
        
        // Difficulty scaling parameters
        const baseEnemySpawnInterval = 1000; // Milliseconds
        const baseEnemySpeed = 1;

        // Player object
        const player = {
            x: 0,
            y: 0,
            size: 25,
            emoji: 'ðŸ˜€' // Player emoji
        };

        // Resizes the canvas to fit the window and sets initial player position
        function resizeCanvas() {
            canvas.width = window.innerWidth > 600 ? 500 : window.innerWidth * 0.95;
            canvas.height = window.innerHeight > 700 ? 500 : window.innerHeight * 0.7;
            player.x = canvas.width / 2;
            player.y = canvas.height / 2;
        }
        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();

        // Resets the game to its initial state
        function resetGame() {
            if (gameLoopId) {
                cancelAnimationFrame(gameLoopId);
            }
            gameOver = false;
            gameStarted = false;
            score = 0;
            enemies = [];
            scoreDisplay.textContent = score;
            messageBox.style.display = 'block';
            restartButton.style.display = 'none';
            backButton.style.display = 'none';
            messageTitle.textContent = "HazÄ±r!";
            messageText.textContent = "BaÅŸlamak iÃ§in fareyi hareket ettir veya dokun.";
        }

        // Spawns a new enemy from a random edge of the canvas
        function spawnEnemy() {
            const side = Math.floor(Math.random() * 4); // 0:top, 1:right, 2:bottom, 3:left
            let x, y, dx, dy;
            const size = Math.random() * 30 + 30;
            const speed = (Math.random() * 1.5 + baseEnemySpeed) + (score / 1000); // Speed increases with score
            const enemyEmoji = 'ðŸ‘»'; // Enemy emoji

            switch(side) {
                case 0: // Top
                    x = Math.random() * canvas.width;
                    y = -size;
                    dx = 0;
                    dy = speed;
                    break;
                case 1: // Right
                    x = canvas.width + size;
                    y = Math.random() * canvas.height;
                    dx = -speed;
                    dy = 0;
                    break;
                case 2: // Bottom
                    x = Math.random() * canvas.width;
                    y = canvas.height + size;
                    dx = 0;
                    dy = -speed;
                    break;
                case 3: // Left
                    x = -size;
                    y = Math.random() * canvas.height;
                    dx = speed;
                    dy = 0;
                    break;
            }

            enemies.push({
                x, y, dx, dy, size,
                emoji: enemyEmoji
            });
        }

        // Handles game over state
        function endGame() {
            gameOver = true;
            messageTitle.textContent = "Oyun Bitti!";
            messageText.textContent = `PuanÄ±n: ${score}`;
            restartButton.style.display = 'block';
            messageBox.style.display = 'block';
            cancelAnimationFrame(gameLoopId);
        }

        // Checks for collision between the player and any enemy
        function checkCollisions() {
            for (let i = 0; i < enemies.length; i++) {
                const enemy = enemies[i];
                // Simple circle collision check
                const distance = Math.hypot(player.x - enemy.x, player.y - enemy.y);
                if (distance < (player.size / 2) + (enemy.size / 2)) {
                    endGame();
                    return true;
                }
            }
            return false;
        }

        // Main update loop for game logic
        function update() {
            if (gameOver) {
                return;
            }

            // Move enemies
            for (let i = enemies.length - 1; i >= 0; i--) {
                const enemy = enemies[i];
                enemy.x += enemy.dx;
                enemy.y += enemy.dy;

                // Remove enemies that are off-screen to prevent memory leaks
                if (enemy.x > canvas.width + 100 || enemy.x < -100 || enemy.y > canvas.height + 100 || enemy.y < -100) {
                    enemies.splice(i, 1);
                }
            }

            // Spawn new enemies based on a time interval
            const currentTime = Date.now();
            const spawnInterval = baseEnemySpawnInterval / (1 + (score / 1500)); // Interval decreases as score increases
            if (currentTime - lastEnemySpawnTime > spawnInterval) {
                spawnEnemy();
                lastEnemySpawnTime = currentTime;
            }

            // Check for collisions and update score
            if (!checkCollisions()) {
                score++;
                scoreDisplay.textContent = score;
            }
        }

        // Main draw loop for rendering
        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            // Draw player emoji
            ctx.font = `${player.size}px Arial`;
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText(player.emoji, player.x, player.y);
            
            // Draw enemies
            enemies.forEach(enemy => {
                ctx.font = `${enemy.size}px Arial`;
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(enemy.emoji, enemy.x, enemy.y);
            });
        }

        // Game loop using requestAnimationFrame
        function gameLoop() {
            update();
            draw();
            gameLoopId = requestAnimationFrame(gameLoop);
        }

        // Handles player movement
        function handleMove(x, y) {
            if (!gameStarted) {
                gameStarted = true;
                messageBox.style.display = 'none';
                backButton.style.display = 'block'; // Show back button when game starts
                lastEnemySpawnTime = Date.now();
                gameLoop();
            }
            player.x = x;
            player.y = y;
        }

        // Event listeners for mouse and touch input
        canvas.addEventListener('mousemove', (e) => {
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            handleMove(x, y);
        });

        canvas.addEventListener('touchmove', (e) => {
            e.preventDefault();
            const rect = canvas.getBoundingClientRect();
            const touch = e.touches[0];
            const x = touch.clientX - rect.left;
            const y = touch.clientY - rect.top;
            handleMove(x, y);
        });

        // Event listener for the restart button
        restartButton.addEventListener('click', () => {
            resetGame();
        });
        
        // Event listener for the back button
        backButton.addEventListener('click', () => {
            // TÄ±klandÄ±ÄŸÄ±nda index.html sayfasÄ±na yÃ¶nlendir.
            window.location.href = 'index.html';
        });

        // Initial game setup
        resetGame();
    </script>
</body>
</html>
